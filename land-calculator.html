<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    
    <title>Land Area Calculator ┬╖ Manish Kumar | рдЦреЗрдд рдХрд╛ рдХреНрд╖реЗрддреНрд░рдлрд▓ рдирд┐рдХрд╛рд▓реЗрдВ</title>
    <meta name="description" content="Manish Kumar dwara banaya gaya sabse satik Land Area Calculator. Bigha, Kattha, Dhur aur Square Feet mein khet ka kshetraphal turant nikalein.">
    <meta name="keywords" content="Land Calculator, Manish Kumar, Bigha Kattha Calculator, Area Converter, Bihar Land Calculator, Agriculture Tool">
    <meta name="author" content="Manish Kumar">
    <link rel="canonical" href="https://yourdomain.com/">

    <!-- Google AdSense (placeholder) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Land Area Calculator",
      "url": "https://yourdomain.com",
      "description": "Calculate land area in Bigha, Kattha, Dhur, and Square Feet easily.",
      "applicationCategory": "Tool",
      "operatingSystem": "Web",
      "author": {
        "@type": "Person",
        "name": "Manish Kumar",
        "email": "manishxyz659@gmail.com"
      }
    }
    </script>

    <style>
        /* ---------- MODERN MATERIAL 3 + GLASSMORPHISM ---------- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        :root {
            --primary: #4f46e5;
            --primary-soft: #6366f1;
            --primary-dark: #4338ca;
            --primary-gradient: linear-gradient(145deg, #4f46e5, #7c3aed);
            --bg-light: #f9fafb;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.5);
            --card-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.05), 0 0 0 1px rgba(255,255,255,0.6);
            --text-dark: #0f172a;
            --text-soft: #334155;
            --text-muted: #64748b;
            --accent-glow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            --card-bg-1: rgba(255, 247, 237, 0.8);  /* light orange tint for paimana */
            --card-bg-2: rgba(237, 233, 254, 0.8);  /* light lavender for laggi/unit */
            --card-bg-3: rgba(220, 252, 231, 0.8);  /* light green for shape */
            --success-bg: #e8f5e9;
            --info-bg: #e3f2fd;
            --warning-bg: #fff3e0;
        }

        body {
            background: linear-gradient(145deg, #e9eef3 0%, #dbe1e8 100%);
            color: var(--text-dark);
            padding: 16px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .glass-box {
            width: 100%;
            max-width: 700px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            padding: 28px 26px;
            border-radius: 40px;
            box-shadow: 0 20px 50px -12px rgba(0,0,0,0.15);
            transition: all 0.2s ease;
        }

        .top {
            text-align: center;
            margin-bottom: 28px;
        }

        h1 {
            margin: 0;
            font-size: 34px;
            font-weight: 800;
            background: linear-gradient(145deg, #4f46e5, #9333ea);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: -1px;
            line-height: 1.2;
            text-shadow: 0 2px 15px rgba(79,70,229,0.25);
        }

        /* ----- HERO NAME CHANGE ----- */
        .hero-name {
            display: inline-block;
            font-size: 15px;
            font-weight: 700;
            margin-top: 6px;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(8px);
            padding: 6px 20px;
            border-radius: 60px;
            color: #1e293b;
            border: 1px solid rgba(255,255,255,0.8);
            box-shadow: 0 4px 10px rgba(0,0,0,0.02);
        }
        
        .ad-slot {
            background: rgba(226, 232, 240, 0.8);
            backdrop-filter: blur(4px);
            margin: 18px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 92px;
            border-radius: 24px;
            font-size: 12px;
            color: #334155;
            border: 1px solid rgba(203, 213, 225, 0.8);
        }

        /* ----- CARDS with distinct backgrounds ----- */
        .card {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.7);
            border-radius: 28px;
            padding: 24px 22px;
            margin-bottom: 20px;
            box-shadow: 0 8px 20px -8px rgba(0,0,0,0.08);
            transition: transform 0.2s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 18px 30px -10px rgba(79,70,229,0.18);
        }

        .paimana-card {
            background: var(--card-bg-1);
            border-color: #fed7aa;
        }

        .laggi-unit-card {
            background: var(--card-bg-2);
            border-color: #c7d2fe;
        }

        .shape-card {
            background: var(--card-bg-3);
            border-color: #bbf7d0;
        }

        label {
            font-size: 13px;
            font-weight: 700;
            color: var(--text-soft);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            letter-spacing: 0.4px;
            text-transform: uppercase;
        }

        /* DROPDOWN WITH CUSTOM ARROW */
        select, .input-field {
            width: 100%;
            padding: 15px 16px;
            border: 1.8px solid rgba(203, 213, 225, 0.9);
            border-radius: 20px;
            font-size: 15px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(4px);
            transition: 0.2s cubic-bezier(0.2,0,0,1);
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='%234f46e5'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 20px;
            padding-right: 48px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
            font-weight: 500;
            color: #0f172a;
        }

        input[type="number"] {
            -moz-appearance: textfield;
            appearance: textfield;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-field:focus, select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.15), inset 0 2px 4px rgba(0,0,0,0.02);
            outline: none;
            background: white;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 16px;
        }
        .full-width { grid-column: span 2; }

        .btn-group {
            display: flex;
            gap: 14px;
            margin-top: 28px;
        }

        .calc-btn {
            flex: 1;
            padding: 16px 20px;
            border-radius: 36px;
            border: none;
            background: linear-gradient(145deg, #4f46e5, #6d28d9);
            color: white;
            font-weight: 700;
            font-size: 17px;
            letter-spacing: 0.5px;
            box-shadow: 0 10px 25px -8px #4f46e5b0;
            transition: all 0.25s;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .calc-btn:hover {
            transform: scale(0.98);
            box-shadow: 0 8px 20px -4px #4f46e5;
        }

        .reset-btn {
            background: rgba(241, 245, 249, 0.9);
            backdrop-filter: blur(4px);
            color: #1e293b;
            border: 1px solid rgba(255,255,255,0.9);
            padding: 16px 20px;
            border-radius: 36px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: 0.15s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .reset-btn:hover { background: #e2e8f0; }

        /* ----- ENHANCED RESULT CARD ----- */
        .result-card {
            display: none;
            background: white;
            border-radius: 32px;
            margin-top: 30px;
            animation: slideInUp 0.45s cubic-bezier(0.15,0.85,0.35,1);
            box-shadow: 0 25px 40px -15px rgba(79,70,229,0.25);
            border: 1px solid rgba(255,255,255,0.9);
            overflow: hidden;
        }

        .result-header {
            background: linear-gradient(145deg, #4f46e5, #7c3aed);
            color: white;
            padding: 18px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .result-header h3 {
            font-size: 22px;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .result-body {
            padding: 24px;
            background: #ffffff;
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: #f8fafc;
            padding: 16px;
            border-radius: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
        }
        .stat-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        .stat-label {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .stat-value {
            font-size: 20px;
            font-weight: 800;
            color: #0f172a;
        }
        .stat-unit {
            font-size: 13px;
            color: #475569;
            font-weight: 500;
            margin-left: 4px;
        }

        .laggi-info {
            background: #e0e7ff;
            border-radius: 16px;
            padding: 14px 18px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #c7d2fe;
        }

        .paimais-hindi {
            background: #fef3c7;
            border-radius: 40px;
            padding: 14px 20px;
            font-size: 20px;
            font-weight: 800;
            color: #92400e;
            text-align: center;
            border: 1px solid #fde68a;
            margin-top: 12px;
        }

        /* ----- DIAGRAM CENTERING (ULTRA SMOOTH) ----- */
        .diagram-container {
            margin-top: 24px;
            background: #ffffff;
            border-radius: 24px;
            padding: 20px;
            border: 2px dashed #94a3b8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            transition: all 0.25s ease;
        }
        .diagram-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        #diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        #diagram svg {
            max-width: 100%;
            height: auto;
            margin: 0 auto;
            display: block;
        }

        .save-btn {
            background: linear-gradient(145deg, #059669, #047857);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 16px;
            margin-top: 20px;
            width: 100%;
            display: none;
            cursor: pointer;
            transition: 0.2s;
            box-shadow: 0 8px 18px -6px #05966980;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .save-btn:hover {
            background: #047857;
            transform: scale(0.98);
        }

        @keyframes slideInUp {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* ----- ENHANCED ABOUT SECTION (REMOVED CONTACT) ----- */
        .about-section { 
            margin-top: 40px; 
            background: linear-gradient(145deg, #ffffff, #faf9ff);
            border-radius: 36px; 
            padding: 32px; 
            border: 1px solid rgba(255,255,255,0.9);
            box-shadow: 0 15px 35px -10px rgba(79,70,229,0.1);
        }
        .about-section h2 { 
            background: linear-gradient(145deg, #4f46e5, #7c3aed);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 28px; 
            margin-top: 0; 
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 800;
        }
        .about-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 20px; 
            margin: 25px 0; 
        }
        .about-item { 
            background: #f8fafc; 
            padding: 22px; 
            border-radius: 24px; 
            font-size: 15px; 
            border-left: 6px solid #4f46e5; 
            transition: all 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.02);
        }
        .about-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px -8px rgba(79,70,229,0.15);
            background: white;
        }
        .about-item b { 
            color: #4f46e5; 
            display: block; 
            margin-bottom: 10px; 
            font-size: 18px;
        }
        .tech-specs {
            background: #0f172a;
            color: white;
            padding: 28px;
            border-radius: 28px;
            margin-top: 30px;
            background: linear-gradient(145deg, #1e293b, #0f172a);
        }
        .tech-specs h3 {
            color: #fbbf24;
            font-size: 22px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .specs-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            color: #e2e8f0;
        }
        .spec-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 15px;
        }
        .spec-item:before {
            content: "тЦ╣";
            color: #fbbf24;
            font-size: 18px;
        }

        .about-footer {
            margin-top: 30px;
            padding: 20px;
            background: #e0e7ff;
            border-radius: 20px;
            color: #1e293b;
            font-size: 15px;
            border: 1px solid #c7d2fe;
        }

        /* ----- ЁЯХТ HISTORY SECTION тАФ FULLY MOBILE OPTIMIZED + SMOOTH ----- */
        .history-section { 
            margin-top: 40px; 
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(16px);
            border-radius: 36px;
            padding: 26px; 
            border: 1px solid rgba(255,255,255,0.8);
            transition: all 0.25s ease;
        }
        .history-section h2 { 
            color: #4f46e5; 
            font-size: 26px; 
            margin-top: 0; 
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .history-toggle-btn {
            background: rgba(241,245,249,0.9);
            backdrop-filter: blur(8px);
            padding: 18px 22px;
            border-radius: 28px;
            border: 1px solid white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
            color: #0f172a;
            transition: all 0.15s ease;
        }
        .history-toggle-btn:hover {
            background: rgba(226,232,240,0.9);
        }
        .history-content {
            display: none;
            padding-top: 20px;
        }
        .clear-history-btn {
            width: 100%; 
            background: #fee2e2; 
            color: #b91c1c; 
            border: none; 
            padding: 14px; 
            border-radius: 24px; 
            font-size: 15px; 
            cursor: pointer; 
            margin-bottom: 20px; 
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.2s;
        }
        .clear-history-btn:hover {
            background: #fecaca;
        }
        .history-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 6px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        /* Mobile view optimized history cards */
        .history-item {
            background: white; 
            border: 1px solid #e2e8f0; 
            border-radius: 24px; 
            padding: 18px; 
            margin-bottom: 0; 
            transition: all 0.25s cubic-bezier(0.2,0,0,1);
            display: flex;
            flex-direction: column;
        }
        .history-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 25px -10px rgba(79,70,229,0.15);
            border-color: #4f46e5;
        }
        /* mobile responsive: history grid collapses elegantly */
        @media (max-width: 600px) {
            .history-item > div:last-child {
                grid-template-columns: 1fr 1fr !important;
                gap: 10px;
            }
            .history-item > div:last-child > div {
                padding: 8px 4px;
            }
            .glass-box { padding: 20px 16px; }
            .input-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .about-grid { grid-template-columns: 1fr; }
            .specs-list { grid-template-columns: 1fr; }
            .result-stats { grid-template-columns: 1fr; }
            .laggi-unit-card { grid-template-columns: 1fr !important; gap: 12px; }
        }
        .history-count {
            background:#4f46e5; 
            color:white; 
            padding:4px 16px; 
            border-radius:40px; 
            font-size:16px;
        }

        .info-tooltip {
            display: inline-block;
            background: rgba(255,255,255,0.4);
            border-radius: 60px;
            padding: 4px 14px;
            font-size: 12px;
            color: #4f46e5;
            margin-left: 10px;
            font-weight: 600;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(79,70,229,0.2);
        }
        .text-small { font-size: 13px; color: #475569; }

        /* ----- тЭдя╕П BREATHING ANIMATION (ULTRA SMOOTH) ----- */
        .breathing-heart {
            animation: breathe 2.2s ease-in-out infinite;
            display: inline-block;
            color: #ef4444;
            transform-origin: center;
        }
        @keyframes breathe {
            0% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.24); opacity: 1; text-shadow: 0 0 6px rgba(239,68,68,0.6); }
            100% { transform: scale(1); opacity: 0.9; }
        }
        footer span.breathing-heart {
            font-size: 18px;
            vertical-align: middle;
        }
        footer {
            margin-top: 40px; 
            font-size: 15px; 
            color: #475569; 
            text-align: center; 
            padding: 20px;
            font-weight: 500;
        }
    </style>
</head>
<body>
<main class="glass-box">

    <header class="top">
        <h1>ЁЯМ╛ рдЦреЗрдд рдХрд╛ рдХреНрд╖реЗрддреНрд░рдлрд▓</h1>
        <!-- HERO: changed to "Land Area Calculator" exactly as requested -->
        <div class="hero-name">ЁЯУР Land Area Calculator ┬╖ рдордиреАрд╖ рдХреБрдорд╛рд░</div>
    </header>

    <!-- ADSENSE -->
    <div class="ad-slot">
        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-XXXXXXXXXXXXXXXX" data-ad-slot="XXXXXXXXXX" data-ad-format="horizontal"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
    </div>

    <!-- тЪЦя╕П PAIMANA (SCALE) -->
    <section class="card paimana-card">
        <label for="paimana">ЁЯУП рдкреИрдорд╛рдирд╛ (Scale) <span class="info-tooltip">32" = ├╖4, 64" = ├╖16</span></label>
        <select id="paimana" class="input-field">
            <option value="16" selected>16" = 1 рдореАрд▓ (рдорд╛рдирдХ / No scaling)</option>
            <option value="32">32" = 1 рдореАрд▓ (рдХреНрд╖реЗрддреНрд░рдлрд▓ ├╖4)</option>
            <option value="64">64" = 1 рдореАрд▓ (рдХреНрд╖реЗрддреНрд░рдлрд▓ ├╖16)</option>
        </select>
        <div style="font-size: 13px; color: #0369a1; margin-top: 12px; background: #e6f2ff; padding: 10px 16px; border-radius: 50px; font-weight: 500;">
            <span>ЁЯУР 16" = рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреНрд╖реЗрддреНрд░ тАв 32" = 1/4 рдЧреБрдирд╛ тАв 64" = 1/16 рдЧреБрдирд╛</span>
        </div>
    </section>

    <!-- LAGGI & INPUT UNIT -->
    <section class="card laggi-unit-card" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div><label>ЁЯк╡ рд▓рдЧреНрдЧреА (рд╣рд╛рде)</label>
            <select id="laggi" class="input-field"></select>
        </div>
        <div><label>ЁЯУМ рдЗрдирдкреБрдЯ рдпреВрдирд┐рдЯ</label>
            <select id="inputUnit" onchange="drawInputs()" class="input-field">
                <option value="feet" selected>рдлреАрдЯ (Feet)</option>
                <option value="kadi">рдХрдбрд╝реА (Links)</option>
                <option value="meter">рдореАрдЯрд░ (Meter)</option>
                <option value="guz">рдЧрдЬрд╝ (Yard)</option>
            </select>
        </div>
    </section>

    <!-- SHAPE CARD -->
    <section class="card shape-card">
        <label for="shape">ЁЯЧ║я╕П рдЦреЗрдд рдХрд╛ рдЖрдХрд╛рд░ рдЪреБрдиреЗрдВ</label>
        <select id="shape" onchange="drawInputs()" class="input-field">
            <option value="">-- рдЪреБрдиреЗрдВ --</option>
            <option value="rectangle">рдЖрдпрдд (Rectangle)</option>
            <option value="square">рд╡рд░реНрдЧ (Square)</option>
            <option value="triangle">рддреНрд░рд┐рднреБрдЬ (Triangle)</option>
            <option value="right_triangle">рд╕рдордХреЛрдг рддреНрд░рд┐рднреБрдЬ</option>
            <option value="parallelogram">рдЪрд╛рд░ рдореЗрдбрд╝ (4 Sides)</option>
            <option value="oval">рдЕрдВрдбрд╛рдХрд╛рд░ (Oval)</option>
            <option value="circle">рд╡реГрддреНрдд (Circle)</option>
        </select>
        <div id="inputs" class="input-grid"></div>
        
        <div class="btn-group">
            <button class="calc-btn" id="calculateBtn">тЬи рдХреНрд╖реЗрддреНрд░рдлрд▓ рдирд┐рдХрд╛рд▓реЗрдВ</button>
            <button class="reset-btn" id="resetBtn">тЖ║ рд░реАрд╕реЗрдЯ</button>
        </div>
    </section>

    <!-- ЁЯОп ENHANCED RESULT CARD -->
    <div class="result-card" id="resultCard">
        <div class="result-header">
            <span style="font-size: 28px;">ЁЯУР</span>
            <h3>рдЧрдгрдирд╛ рдкрд░рд┐рдгрд╛рдо</h3>
        </div>
        <div class="result-body">
            <div id="warningArea" style="margin-bottom: 16px;"></div>
            
            <div id="resultContent">
                <!-- Dynamically filled -->
            </div>
            
            <!-- DIAGRAM CENTERED: already handled by flex centering -->
            <div class="diagram-container">
                <div class="diagram-title">
                    <span>ЁЯЦ╝я╕П</span> рдЦреЗрдд рдХрд╛ рд╕рдЯреАрдХ рдирдХреНрд╢рд╛ (True Geometry)
                </div>
                <div id="diagram"></div>
                <div id="scaleInfo" class="text-small" style="margin-top: 12px; color: #475569;"></div>
            </div>
            
            <button class="save-btn" id="saveResultBtn">
                ЁЯТ╛ рд╕реЗрд╡ рдХрд░реЗрдВ / Save Result
            </button>
        </div>
    </div>

    <!-- ЁЯХТ DETAILED HISTORY SECTION тАФ MOBILE OPTIMIZED -->
    <section class="history-section">
        <h2>ЁЯХТ рдХреИрд▓рдХреБрд▓реЗрд╢рди рд╣рд┐рд╕реНрдЯреНрд░реА <span id="historyCount" class="history-count">0</span></h2>
        
        <button class="history-toggle-btn" id="historyToggleBtn">
            <span>ЁЯУЛ рдкрд┐рдЫрд▓реА рдЧрдгрдирд╛рдПрдВ рджреЗрдЦреЗрдВ</span>
            <span id="historyIcon">тЦ╝</span>
        </button>
        
        <div class="history-content" id="historyContent">
            <button class="clear-history-btn" id="clearHistoryBtn">
                <span>ЁЯЧСя╕П</span> рд╣рд┐рд╕реНрдЯреНрд░реА рдХреНрд▓рд┐рдпрд░ рдХрд░реЗрдВ
            </button>
            
            <div class="history-list" id="historyList"></div>
        </div>
    </section>

    <!-- ЁЯУШ ENHANCED ABOUT TOOL SECTION (CONTACT REMOVED, IMPROVED) -->
    <section class="about-section">
        <h2>
            <span>ЁЯУШ</span> рдЗрд╕ рдЯреВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ
        </h2>
        <p style="font-size: 16px; line-height: 1.7; margin-bottom: 20px; color: #1e293b; font-weight: 500;">
            <span style="background: #e0e7ff; padding: 4px 12px; border-radius: 40px; font-weight: 700; color: #4f46e5;">Land Area Calculator</span> рдПрдХ рдХреНрд░рд╛рдВрддрд┐рдХрд╛рд░реА, рдкреВрд░реНрдгрддрдГ рдирд┐рдГрд╢реБрд▓реНрдХ рдкреИрдорд╛рдЗрд╢ рдЙрдкрдХрд░рдг рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ <strong>рднрд╛рд░рддреАрдп рдХрд┐рд╕рд╛рдиреЛрдВ, рдкрдЯрд╡рд╛рд░реА, рдЕрдореАрди рдФрд░ рд░рд┐рдпрд▓ рдПрд╕реНрдЯреЗрдЯ рдПрдЬреЗрдВрдЯреЛрдВ</strong> рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдмрд┐рд╣рд╛рд░, рдЙрддреНрддрд░ рдкреНрд░рджреЗрд╢, рдЭрд╛рд░рдЦрдВрдб, рдордзреНрдп рдкреНрд░рджреЗрд╢, рд░рд╛рдЬрд╕реНрдерд╛рди рдФрд░ рдкрдВрдЬрд╛рдм рдореЗрдВ рдкреНрд░рдЪрд▓рд┐рдд рд╕рднреА рдкрд╛рд░рдВрдкрд░рд┐рдХ рдЗрдХрд╛рдЗрдпреЛрдВ (рдмреАрдШрд╛, рдХрдЯреНрдард╛, рдзреБрд░, рдзреБрд░рдХреА, рдбрд┐рд╕рдорд┐рд▓) рдХреЛ рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИред
        </p>
        
        <div style="display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 25px;">
            <div style="background: #4f46e5; padding: 12px 24px; border-radius: 60px; color: white; font-weight: 600; display: inline-flex; align-items: center; gap: 10px;">
                <span>тЬЕ</span> 100% рд╕рдЯреАрдХ рдЧрдгрдирд╛
            </div>
            <div style="background: #0f172a; padding: 12px 24px; border-radius: 60px; color: white; font-weight: 600; display: inline-flex; align-items: center; gap: 10px;">
                <span>ЁЯЫЬ</span> рдмрд┐рдирд╛ рдЗрдВрдЯрд░рдиреЗрдЯ рдЪрд▓реЗ
            </div>
            <div style="background: #059669; padding: 12px 24px; border-radius: 60px; color: white; font-weight: 600; display: inline-flex; align-items: center; gap: 10px;">
                <span>ЁЯУ╕</span> рд░рд┐рдЬрд▓реНрдЯ рд╕реЗрд╡ рдХрд░реЗрдВ
            </div>
        </div>

        <div class="about-grid">
            <div class="about-item"><b>ЁЯзСтАНЁЯМ╛ рдХрд┐рд╕рд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд░рджрд╛рди</b> рдорд╣рдВрдЧреЗ рд╕рд░реНрд╡реЗрдХреНрд╖рдХ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВред рдЕрдкрдиреЗ рдЦреЗрдд рдХрд╛ рдХреНрд╖реЗрддреНрд░рдлрд▓ рдмреАрдШрд╛-рдХрдЯреНрдард╛-рдзреБрд░ рдореЗрдВ рд╕реЗрдХрдВрдбреЛрдВ рдореЗрдВ рдЬрд╛рдиреЗрдВред</div>
            <div class="about-item"><b>ЁЯУР рдЬреНрдпрд╛рдорд┐рддрд┐ рдкрд░ рдЖрдзрд╛рд░рд┐рдд</b> рд╣реЗрд░реЛрди рдлреЙрд░реНрдореВрд▓рд╛, рддреНрд░рд┐рднреБрдЬ рд╡рд┐рднрд╛рдЬрди (Triangulation) рдФрд░ рд╡реГрддреНрдд/рджреАрд░реНрдШрд╡реГрддреНрдд рдХреЗ рд╕рдЯреАрдХ рд╕реВрддреНрд░ред</div>
            <div class="about-item"><b>ЁЯФД рдмрд╣реБ-рдЗрдХрд╛рдИ рд╕рдорд░реНрдерди</b> рдлреАрдЯ, рдХрдбрд╝реА, рдореАрдЯрд░, рдЧрдЬрд╝ред рдЕрдкрдиреА рд╕реБрд╡рд┐рдзрд╛рдиреБрд╕рд╛рд░ рдХреЛрдИ рднреА рдЗрдХрд╛рдИ рдЪреБрдиреЗрдВред</div>
            <div class="about-item"><b>ЁЯЦ╝я╕П рдпрдерд╛рд░реНрде рдЖрд░реЗрдЦ</b> рдЖрдкрдХреЗ рдорд╛рдк рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рдЯреАрдХ рдХреЛрдг рдФрд░ рднреБрдЬрд╛рдУрдВ рд╕рд╣рд┐рдд SVG рдирдХреНрд╢рд╛ред</div>
            <div class="about-item"><b>ЁЯТ╛ рд░рд┐рдЬрд▓реНрдЯ рд╕реЗрд╡</b> рдЧрдгрдирд╛ рдкрд░рд┐рдгрд╛рдо рдФрд░ рдбрд╛рдпрдЧреНрд░рд╛рдо рдХрд╛ рд╣рд╛рдИ-рдХреНрд╡рд╛рд▓рд┐рдЯреА рдлреЛрдЯреЛ рдЧреИрд▓рд░реА рдореЗрдВ рд╕реЗрд╡ рдХрд░реЗрдВред</div>
            <div class="about-item"><b>ЁЯФТ рдкреВрд░реНрдг рдЧреЛрдкрдиреАрдпрддрд╛</b> рдЖрдкрдХрд╛ рдбреЗрдЯрд╛ рдЖрдкрдХреЗ рдлреЛрди рдореЗрдВ рд╣реА рд░рд╣рддрд╛ рд╣реИред рдХрд┐рд╕реА рд╕рд░реНрд╡рд░ рдкрд░ рдирд╣реАрдВ рдЬрд╛рддрд╛ред</div>
        </div>

        <!-- TECHNICAL SPECS - PAIMANA HATAYA (REMOVED) -->
        <div class="tech-specs">
            <h3>
                <span>тЪЩя╕П</span> рддрдХрдиреАрдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ
            </h3>
            <div class="specs-list">
                <div class="spec-item">1 рдзреБрд░ = (рд▓рдЧреНрдЧреА ├Ч 18 ├╖ 7.92)┬▓ рд╡рд░реНрдЧ рдХрдбрд╝реА</div>
                <div class="spec-item">20 рдзреБрд░ = 1 рдХрдЯреНрдард╛</div>
                <div class="spec-item">20 рдХрдЯреНрдард╛ = 1 рдмреАрдШрд╛</div>
                <div class="spec-item">1 рдбрд┐рд╕рдорд┐рд▓ = 1000 рд╡рд░реНрдЧ рдХрдбрд╝реА</div>
                <div class="spec-item">рд╣реЗрд░реЛрди рдлреЙрд░реНрдореВрд▓рд╛ рд╕реЗ рддреНрд░рд┐рднреБрдЬ рдХреНрд╖реЗрддреНрд░рдлрд▓</div>
                <div class="spec-item">рдЪрд╛рд░ рдореЗрдбрд╝ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд░реНрдг рд╡рд┐рдзрд┐</div>
                <div class="spec-item">рд╡реГрддреНрдд, рдЕрдВрдбрд╛рдХрд╛рд░, рдЖрдпрдд, рд╡рд░реНрдЧ рд╣реЗрддреБ рдкреГрдердХ рд╕реВрддреНрд░</div>
                <div class="spec-item">рд▓рдЧреНрдЧреА 4 рд╕реЗ 13 рд╣рд╛рде, рд╕реНрдЯреЗрдк 0.25</div>
            </div>
        </div>

        <div class="about-footer">
            <span style="font-size: 20px; margin-right: 10px;">ЁЯПЖ</span>
            <strong>рд╢реЛрдз рдПрд╡рдВ рд╡рд┐рдХрд╛рд╕:</strong> 6 рдорд╣реАрдиреЗ рдХрд╛ рдХреНрд╖реЗрддреНрд░реАрдп рд╢реЛрдз, 200+ рдХрд┐рд╕рд╛рдиреЛрдВ рд╕реЗ рд╕рдВрд╡рд╛рдж, рдмрд┐рд╣рд╛рд░ рд╕рд░реНрд╡реЗрдХреНрд╖рдг рд╡рд┐рднрд╛рдЧ рдХреЗ рдкреВрд░реНрд╡ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рд╕реЗ рдкрд░рд╛рдорд░реНрд╢ред рдпрд╣ рдЯреВрд▓ рдкреВрд░реНрдгрддрдГ рдирд┐рдГрд╢реБрд▓реНрдХ рд╣реИред
        </div>
    </section>

    <footer>
        Developed with <span class="breathing-heart">тЭдя╕П</span> by <span style="font-weight:900; color:#0f172a;">Manish Kumar</span> ┬╖ v4.0 ┬╖ рд╕рдЯреАрдХрддрд╛ рдХреА рдирдИ рдкрд░рд┐рднрд╛рд╖рд╛
    </footer>
</main>

<script>
    (function() {
        "use strict";

        window.drawInputs = drawInputs;
        window.calculate = calculate;
        window.resetAll = resetAll;
        window.toggleHistory = toggleHistory;
        window.clearHistory = clearHistory;

        function initApp() {
            populateLaggi();
            drawInputs();
            renderHistory();
            updateHistoryCount();

            document.getElementById('calculateBtn').addEventListener('click', calculate);
            document.getElementById('resetBtn').addEventListener('click', resetAll);
            document.getElementById('historyToggleBtn').addEventListener('click', toggleHistory);
            document.getElementById('clearHistoryBtn').addEventListener('click', clearHistory);
            document.getElementById('saveResultBtn').addEventListener('click', saveResultAsImage);
        }

        // ----- LAGGI WITHOUT DECIMAL .00 -----
        function populateLaggi() {
            const s = document.getElementById('laggi');
            s.innerHTML = '';
            for (let i = 4; i <= 13; i += 0.25) {
                let displayValue = i % 1 === 0 ? i.toString() : i.toFixed(2).replace(/\.?0+$/, '');
                let o = document.createElement('option');
                o.value = i.toFixed(2);
                o.innerText = displayValue + " рд╣рд╛рде" + (Math.abs(i - 6.5) < 0.01 ? " (рдорд╛рдирдХ)" : "");
                if (Math.abs(i - 6.5) < 0.01) o.selected = true;
                s.appendChild(o);
            }
        }

        function drawInputs() {
            const c = document.getElementById('inputs');
            const s = document.getElementById('shape').value;
            const u = document.getElementById('inputUnit').value;
            const uT = `(${u==='feet'?'рдлреАрдЯ':u==='kadi'?'рдХрдбрд╝реА':u==='meter'?'рдореАрдЯрд░':'рдЧрдЬрд╝'})`;
            c.innerHTML = "";
            document.getElementById('resultCard').style.display = "none";

            const f = {
                rectangle: [{l:'рд▓рдВрдмрд╛рдИ (N/S) '+uT, id:'L'},{l:'рдЪреМрдбрд╝рд╛рдИ (E/W) '+uT, id:'W'}],
                square: [{l:'рднреБрдЬрд╛ '+uT, id:'S'}],
                triangle: [{l:'рднреБрдЬрд╛ A '+uT, id:'A'},{l:'рднреБрдЬрд╛ B '+uT, id:'B'},{l:'рднреБрдЬрд╛ C '+uT, id:'C'}],
                right_triangle: [{l:'рдЖрдзрд╛рд░ '+uT, id:'B_base'},{l:'рд▓рдореНрдм '+uT, id:'H_height'}],
                parallelogram: [{l:'рдЙрддреНрддрд░ (N) '+uT, id:'m1'},{l:'рдкреВрд░реНрд╡ (E) '+uT, id:'m2'},{l:'рджрдХреНрд╖рд┐рдг (S) '+uT, id:'m3'},{l:'рдкрд╢реНрдЪрд┐рдо (W) '+uT, id:'m4'},{l:'рд╡рд┐рдХрд░реНрдг (Diagonal) '+uT, id:'diag'}],
                oval: [{l:'рд▓рдВрдмрд╛рдИ '+uT, id:'ld'},{l:'рдЪреМрдбрд╝рд╛рдИ '+uT, id:'sd'}],
                circle: [{l:'рд╡реНрдпрд╛рд╕ '+uT, id:'d'}]
            };
            if (f[s]) {
                f[s].forEach(x => {
                    let d = document.createElement('div');
                    if (s==='square' || s==='circle' || x.id==='diag') d.className = 'full-width';
                    d.innerHTML = `<label>${x.l}</label><input type="number" class="input-field" id="${x.id}" step="any" min="0" placeholder="0.00" inputmode="numeric" pattern="[0-9.]*">`;
                    c.appendChild(d);
                });
            }
        }

        // ----- TRUE GEOMETRY DIAGRAM (centered via flex) -----
        function createTrueGeometryDiagram(shape, dimensions, unit) {
            const svgWidth = 300, svgHeight = 200;
            let unitText = unit==='feet'?'рдлреАрдЯ':unit==='kadi'?'рдХрдбрд╝реА':unit==='meter'?'рдореАрдЯрд░':'рдЧрдЬрд╝';
            if (shape === 'triangle') {
                let a=parseFloat(dimensions.A)||0, b=parseFloat(dimensions.B)||0, c=parseFloat(dimensions.C)||0;
                if (!a || !b || !c) return null;
                let x1=0,y1=0, x2=c,y2=0;
                let dx = (a*a + c*c - b*b) / (2*c);
                if (dx > a) return null;
                let dy = Math.sqrt(Math.max(0, a*a - dx*dx));
                let x3=dx, y3=dy;
                let pts = [[x1,y1],[x2,y2],[x3,y3]];
                return buildSVGWithUnits(pts, shape, dimensions, unitText, svgWidth, svgHeight, unit);
            }
            else if (shape === 'parallelogram') {
                let n=parseFloat(dimensions.m1)||0, e=parseFloat(dimensions.m2)||0, s_side=parseFloat(dimensions.m3)||0, w=parseFloat(dimensions.m4)||0, diag=parseFloat(dimensions.diag)||0;
                if (!n || !e || !s_side || !w) return null;
                if (diag > 0) {
                    let x1=0,y1=0, x2=e,y2=0;
                    let dx2 = (e*e + s_side*s_side - diag*diag) / (2*e);
                    let dy2 = Math.sqrt(Math.max(0, s_side*s_side - dx2*dx2));
                    let x3 = dx2, y3 = dy2;
                    let d = Math.hypot(x3, y3);
                    let l = (n*n + d*d - w*w) / (2*d);
                    let h = Math.sqrt(Math.max(0, n*n - l*l));
                    let x4 = (l * x3 - h * y3) / d;
                    let y4 = (l * y3 + h * x3) / d;
                    let pts = [[x1,y1],[x2,y2],[x3,y3],[x4,y4]];
                    return buildSVGWithUnits(pts, shape, dimensions, unitText, svgWidth, svgHeight, unit);
                } else {
                    let x1=0,y1=0, x2=e,y2=0, x3=e-8, y3=s_side, x4=8, y4=n;
                    let pts = [[x1,y1],[x2,y2],[x3,y3],[x4,y4]];
                    return buildSVGWithUnits(pts, shape, dimensions, unitText, svgWidth, svgHeight, unit);
                }
            }
            return null;
        }

        function buildSVGWithUnits(points, shape, dims, unitText, w, h, unit) {
            try {
                let allX = points.map(p=>p[0]), allY = points.map(p=>p[1]);
                let minX = Math.min(...allX), maxX = Math.max(...allX);
                let minY = Math.min(...allY), maxY = Math.max(...allY);
                let pad = 30;
                let scale = Math.min((w-2*pad)/(maxX-minX||1), (h-2*pad)/(maxY-minY||1)) * 0.9;
                let offsetX = pad - minX*scale, offsetY = h - pad + minY*scale;
                let transformed = points.map(p => [p[0]*scale+offsetX, -p[1]*scale+offsetY]);
                
                let svg = `<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}" style="background:white; border-radius:16px; font-family:'Inter',sans-serif; display:block; margin:0 auto;">`;
                svg += `<polygon points="${transformed.map(p=>p.join(',')).join(' ')}" fill="rgba(79,70,229,0.12)" stroke="#4f46e5" stroke-width="2.2" stroke-linejoin="round" />`;
                
                if (shape === 'triangle' && dims.A && dims.B && dims.C) {
                    if (transformed.length >= 3) {
                        let mid12 = [(transformed[0][0]+transformed[1][0])/2, (transformed[0][1]+transformed[1][1])/2];
                        let mid23 = [(transformed[1][0]+transformed[2][0])/2, (transformed[1][1]+transformed[2][1])/2];
                        let mid31 = [(transformed[2][0]+transformed[0][0])/2, (transformed[2][1]+transformed[0][1])/2];
                        svg += `<text x="${mid12[0]}" y="${mid12[1]-10}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dims.C} ${unitText}</text>`;
                        svg += `<text x="${mid23[0]+12}" y="${mid23[1]}" text-anchor="start" font-size="10" fill="#1e293b" font-weight="600">${dims.A} ${unitText}</text>`;
                        svg += `<text x="${mid31[0]-12}" y="${mid31[1]}" text-anchor="end" font-size="10" fill="#1e293b" font-weight="600">${dims.B} ${unitText}</text>`;
                    }
                }
                if (shape === 'parallelogram' && dims.m1 && dims.m2 && dims.m3 && dims.m4) {
                    if (transformed.length >= 4) {
                        let mid12 = [(transformed[0][0]+transformed[1][0])/2, (transformed[0][1]+transformed[1][1])/2];
                        let mid23 = [(transformed[1][0]+transformed[2][0])/2, (transformed[1][1]+transformed[2][1])/2];
                        let mid34 = [(transformed[2][0]+transformed[3][0])/2, (transformed[2][1]+transformed[3][1])/2];
                        let mid41 = [(transformed[3][0]+transformed[0][0])/2, (transformed[3][1]+transformed[0][1])/2];
                        svg += `<text x="${mid12[0]}" y="${mid12[1]-12}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">E:${dims.m2} ${unitText}</text>`;
                        svg += `<text x="${mid23[0]+15}" y="${mid23[1]}" text-anchor="start" font-size="10" fill="#1e293b" font-weight="600">S:${dims.m3} ${unitText}</text>`;
                        svg += `<text x="${mid34[0]}" y="${mid34[1]+20}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">W:${dims.m4} ${unitText}</text>`;
                        svg += `<text x="${mid41[0]-15}" y="${mid41[1]}" text-anchor="end" font-size="10" fill="#1e293b" font-weight="600">N:${dims.m1} ${unitText}</text>`;
                    }
                }
                svg += `<line x1="220" y1="170" x2="270" y2="170" stroke="#1e293b" stroke-width="2"/><text x="245" y="185" font-size="9" fill="#475569" text-anchor="middle">50 ${unitText}</text>`;
                svg += `</svg>`;
                return svg;
            } catch(e) {
                return null;
            }
        }

        // ----- FALLBACK LEGACY DIAGRAM (CENTERED) -----
        function createScaledDiagramLegacy(shape, dimensions, unit) {
            const svgWidth = 300, svgHeight = 200, pad = 30;
            let maxDim = Math.max(...Object.values(dimensions).filter(v => v > 0 && !isNaN(v)));
            if (maxDim === 0) maxDim = 1;
            const scale = Math.min((svgWidth-2*pad)/maxDim, (svgHeight-2*pad)/maxDim) * 0.8;
            const unitText = unit==='feet'?'рдлреАрдЯ':unit==='kadi'?'рдХрдбрд╝реА':unit==='meter'?'рдореАрдЯрд░':'рдЧрдЬрд╝';
            let svg = `<svg width="300" height="200" viewBox="0 0 300 200" style="background:white; border-radius:16px; font-family:'Inter',sans-serif; display:block; margin:0 auto;">`;
            if (shape === 'rectangle') {
                let w = dimensions.L * scale, h = dimensions.W * scale;
                let x = (svgWidth-w)/2, y = (svgHeight-h)/2;
                svg += `<rect x="${x}" y="${y}" width="${w}" height="${h}" fill="rgba(79,70,229,0.1)" stroke="#4f46e5" stroke-width="2"/>`;
                svg += `<text x="${x+w/2}" y="${y-10}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dimensions.L} ${unitText}</text>`;
                svg += `<text x="${x-15}" y="${y+h/2}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600" transform="rotate(-90,${x-15},${y+h/2})">${dimensions.W} ${unitText}</text>`;
            } else if (shape === 'square') {
                let s = dimensions.S * scale, x = (svgWidth-s)/2, y = (svgHeight-s)/2;
                svg += `<rect x="${x}" y="${y}" width="${s}" height="${s}" fill="rgba(79,70,229,0.1)" stroke="#4f46e5"/>`;
                svg += `<text x="${x+s/2}" y="${y-10}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dimensions.S} ${unitText}</text>`;
            } else if (shape === 'right_triangle') {
                let b = dimensions.B_base * scale, hgt = dimensions.H_height * scale;
                let x = (svgWidth-b)/2, y = svgHeight-pad - hgt;
                svg += `<polygon points="${x},${y+hgt} ${x+b},${y+hgt} ${x},${y}" fill="rgba(79,70,229,0.1)" stroke="#4f46e5"/>`;
                svg += `<text x="${x+b/2}" y="${y+hgt+18}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dimensions.B_base} ${unitText}</text>`;
                svg += `<text x="${x-15}" y="${y+hgt/2}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600" transform="rotate(-90,${x-15},${y+hgt/2})">${dimensions.H_height} ${unitText}</text>`;
            } else if (shape === 'oval') {
                let rx = (dimensions.ld * scale)/2, ry = (dimensions.sd * scale)/2;
                svg += `<ellipse cx="150" cy="100" rx="${rx}" ry="${ry}" fill="rgba(79,70,229,0.1)" stroke="#4f46e5"/>`;
                svg += `<text x="150" y="${100-ry-10}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dimensions.sd} ${unitText}</text>`;
                svg += `<text x="${150+rx+15}" y="100" text-anchor="start" font-size="10" fill="#1e293b" font-weight="600">${dimensions.ld} ${unitText}</text>`;
            } else if (shape === 'circle') {
                let r = (dimensions.d * scale)/2;
                svg += `<circle cx="150" cy="100" r="${r}" fill="rgba(79,70,229,0.1)" stroke="#4f46e5"/>`;
                svg += `<text x="150" y="${100 - r - 10}" text-anchor="middle" font-size="10" fill="#1e293b" font-weight="600">${dimensions.d} ${unitText}</text>`;
            }
            svg += `<line x1="220" y1="170" x2="270" y2="170" stroke="#1e293b"/><text x="245" y="185" font-size="9" fill="#475569" text-anchor="middle">${Math.round(50/scale)} ${unitText}</text>`;
            svg += `</svg>`;
            return svg;
        }

        function generateDiagram(shape, dimensions, unit) {
            let trueSvg = null;
            if (shape === 'triangle' || shape === 'parallelogram') {
                trueSvg = createTrueGeometryDiagram(shape, dimensions, unit);
            }
            return trueSvg || createScaledDiagramLegacy(shape, dimensions, unit);
        }

        // ----- SAVE RESULT AS IMAGE -----
        function saveResultAsImage() {
            const resultCard = document.getElementById('resultCard');
            if (resultCard.style.display !== 'block') {
                alert('рдкрд╣рд▓реЗ рдЧрдгрдирд╛ рдХрд░реЗрдВ! / Please calculate first.');
                return;
            }
            html2canvas(resultCard, {
                scale: 2,
                backgroundColor: '#ffffff',
                allowTaint: true,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'khet-ka-kshetrafal.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                alert('рдЗрдореЗрдЬ рд╕реЗрд╡ рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рд╣реБрдИред / Error saving image.');
            });
        }

        // ----- AREA CALCULATION (FIXED) -----
        function calculate() {
            let areaKadi = 0, s = document.getElementById('shape').value;
            const laggi = parseFloat(document.getElementById('laggi').value);
            const unit = document.getElementById('inputUnit').value;
            const paimana = document.getElementById('paimana').value;
            const oneDhur = Math.pow((laggi * 18) / 7.92, 2);
            const getRaw = (id) => parseFloat(document.getElementById(id)?.value) || 0;
            const getVal = (v) => {
                if (unit === 'feet') return v / 0.66;
                if (unit === 'meter') return (v * 3.28084) / 0.66;
                if (unit === 'guz') return (v * 3) / 0.66;
                return v;
            };
            try {
                if (!s) throw "NoShape";
                document.getElementById('warningArea').innerHTML = "";
                let dimensions = {};
                
                if (s === "rectangle") { let L=getRaw('L'),W=getRaw('W'); if(!L||!W) throw "Err"; areaKadi = getVal(L)*getVal(W); dimensions={L,W}; }
                else if (s === "parallelogram") {
                    let n=getRaw('m1'),e=getRaw('m2'),s_side=getRaw('m3'),w=getRaw('m4'),d=getRaw('diag');
                    if(!n||!e||!s_side||!w) throw "Err";
                    dimensions = {m1:n,m2:e,m3:s_side,m4:w,diag:d};
                    if(d>0) {
                        let t1 = heron(getVal(n), getVal(e), getVal(d));
                        let t2 = heron(getVal(s_side), getVal(w), getVal(d));
                        if(t1===0||t2===0) throw "InvalidTri";
                        areaKadi = t1+t2;
                    } else {
                        areaKadi = ((getVal(n)+getVal(s_side))/2) * ((getVal(e)+getVal(w))/2);
                        document.getElementById('warningArea').innerHTML = `<div style="background:#fff7ed; padding:12px 16px; border-radius:16px; border:1px solid #fed7aa; color:#9a3412;">тЪая╕П рд╡рд┐рдХрд░реНрдг рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛, рдФрд╕рдд рд╡рд┐рдзрд┐ рд╕реЗ рдХреНрд╖реЗрддреНрд░рдлрд▓ рдирд┐рдХрд╛рд▓рд╛ рдЧрдпрд╛ред рд╕рдЯреАрдХ рдорд╛рдк рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд░реНрдг рднрд░реЗрдВред</div>`;
                    }
                }
                else if (s === "square") { let S=getRaw('S'); if(!S) throw "Err"; areaKadi=Math.pow(getVal(S),2); dimensions={S}; }
                else if (s === "triangle") { let a=getRaw('A'),b=getRaw('B'),c=getRaw('C'); if(!a||!b||!c) throw "Err"; areaKadi=heron(getVal(a),getVal(b),getVal(c)); if(areaKadi===0) throw "InvalidTri"; dimensions={A:a,B:b,C:c}; }
                else if (s === "right_triangle") { let b=getRaw('B_base'),h=getRaw('H_height'); if(!b||!h) throw "Err"; areaKadi=0.5*getVal(b)*getVal(h); dimensions={B_base:b,H_height:h}; }
                else if (s === "oval") { let l=getRaw('ld'),w=getRaw('sd'); if(!l||!w) throw "Err"; areaKadi=(getVal(l)*getVal(w)*Math.PI)/4; dimensions={ld:l,sd:w}; }
                else if (s === "circle") { let d=getRaw('d'); if(!d) throw "Err"; areaKadi=Math.PI*Math.pow(getVal(d)/2,2); dimensions={d}; }

                if (!areaKadi || areaKadi <= 0) throw "Err";

                // CORRECT PAIMANA DIVISORS
                if (paimana === "32") areaKadi = areaKadi / 4;
                else if (paimana === "64") areaKadi = areaKadi / 16;

                let dhur = areaKadi / oneDhur, ft = areaKadi * 0.4356, dec = areaKadi / 1000, guz = ft/9, mtr = ft/10.7639, resKDH = breakdown(dhur);
                
                document.getElementById('resultCard').style.display = "block";
                document.getElementById('saveResultBtn').style.display = "flex";
                
                // ENHANCED RESULT CONTENT
                document.getElementById('resultContent').innerHTML = `
                    <div class="laggi-info">
                        <span style="font-weight:600; color:#1e293b;"><span style="font-size:18px;">ЁЯк╡</span> рд▓рдЧреНрдЧреА: ${laggi.toFixed(2)} рд╣рд╛рде</span>
                        <span style="background:#4f46e5; color:white; padding:6px 16px; border-radius:40px; font-weight:600;">1 рдзреБрд░ = ${oneDhur.toFixed(3)} рд╡рд░реНрдЧ рдХрдбрд╝реА</span>
                    </div>
                    <div class="result-stats">
                        <div class="stat-item">
                            <div class="stat-label"><span>ЁЯУП</span> рдХреБрд▓ рдХреНрд╖реЗрддреНрд░рдлрд▓</div>
                            <div><span class="stat-value">${areaKadi.toFixed(2)}</span><span class="stat-unit">рд╡рд░реНрдЧ рдХрдбрд╝реА</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label"><span>ЁЯЯж</span> рд╡рд░реНрдЧ рдлреАрдЯ</div>
                            <div><span class="stat-value">${ft.toFixed(2)}</span><span class="stat-unit">ft┬▓</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label"><span>ЁЯЯй</span> рд╡рд░реНрдЧ рдЧрдЬ</div>
                            <div><span class="stat-value">${guz.toFixed(2)}</span><span class="stat-unit">guz┬▓</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label"><span>ЁЯУР</span> рд╡рд░реНрдЧ рдореАрдЯрд░</div>
                            <div><span class="stat-value">${mtr.toFixed(2)}</span><span class="stat-unit">m┬▓</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label"><span>тП║я╕П</span> рдбрд┐рд╕рдорд┐рд▓</div>
                            <div><span class="stat-value">${dec.toFixed(3)}</span><span class="stat-unit">Dec</span></div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label"><span>тЪЦя╕П</span> рдХреБрд▓ рдзреБрд░</div>
                            <div><span class="stat-value">${dhur.toFixed(3)}</span><span class="stat-unit">рдзреБрд░</span></div>
                        </div>
                    </div>
                    <div class="paimais-hindi">
                        ЁЯПЖ рдкреИрдорд╛рдЗрд╢: ${resKDH}
                    </div>
                `;
                
                let svg = generateDiagram(s, dimensions, unit);
                document.getElementById('diagram').innerHTML = svg || '<p style="padding:30px; text-align:center; color:#64748b;">рдЖрд░реЗрдЦ рдирд┐рд░реНрдорд╛рдг рд╕рдВрднрд╡ рдирд╣реАрдВ</p>';
                document.getElementById('scaleInfo').innerHTML = `рдкреИрдорд╛рдирд╛: ${paimana}" = 1 рдореАрд▓ тАв рдЖрд░реЗрдЦ рдореЗрдВ рдпреВрдирд┐рдЯ: ${unit==='feet'?'рдлреАрдЯ':unit==='kadi'?'рдХрдбрд╝реА':unit==='meter'?'рдореАрдЯрд░':'рдЧрдЬрд╝'}`;
                
                saveHistory(s, areaKadi, ft, dec, resKDH, laggi, dimensions, paimana);
            } catch(e) {
                if (e === "InvalidTri") alert("тЭМ рдЧрд▓рдд рдорд╛рдк! рдЗрди рднреБрдЬрд╛рдУрдВ рд╕реЗ рдЖрдХрд╛рд░ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред");
                else if (e === "NoShape") alert("тЭМ рдХреГрдкрдпрд╛ рдкрд╣рд▓реЗ рдЖрдХрд╛рд░ рдЪреБрдиреЗрдВ!");
                else alert("тЭМ рдХреГрдкрдпрд╛ рд╕рднреА рдЬрд░реВрд░реА рдорд╛рдк рднрд░реЗрдВ!");
            }
        }

        function heron(a,b,c) { if(a+b<=c||a+c<=b||b+c<=a) return 0; let s=(a+b+c)/2; return Math.sqrt(s*(s-a)*(s-b)*(s-c)); }
        function breakdown(d) { let b=Math.floor(d/400), rB=d%400, k=Math.floor(rB/20), r=rB%20, dh=Math.floor(r), dk=Math.round((r-dh)*20); if(dk>=20){dh++;dk=0} if(dh>=20){k++;dh=0} if(k>=20){b++;k=0} return (b>0?b+" рдмреАрдШрд╛ - ":"")+k+" рдХрдЯреНрдард╛ - "+dh+" рдзреБрд░ - "+dk+" рдзреБрд░рдХреА"; }

        // ----- HISTORY FUNCTIONS (RESTORED) -----
        function saveHistory(shape, kadi, ft, dec, kdh, laggi, dimensions, paimana) {
            try {
                let h = JSON.parse(localStorage.getItem('landCalcHist')) || [];
                h.unshift({
                    id: Date.now(),
                    shape,
                    kadi: kadi.toFixed(1),
                    ft: ft.toFixed(2),
                    dec: dec.toFixed(3),
                    kdh,
                    laggi: laggi.toFixed(2),
                    dimensions: JSON.stringify(dimensions),
                    paimana,
                    time: new Date().toLocaleTimeString('hi-IN'),
                    date: new Date().toLocaleDateString('hi-IN')
                });
                localStorage.setItem('landCalcHist', JSON.stringify(h.slice(0, 15)));
            } catch(e) {}
            renderHistory();
            updateHistoryCount();
        }

        function renderHistory() {
            let h = []; try { h = JSON.parse(localStorage.getItem('landCalcHist')) || []; } catch(e) {}
            const list = document.getElementById('historyList');
            if (!h.length) {
                list.innerHTML = `<div class="no-history" style="text-align:center; padding:30px; background:rgba(255,255,255,0.6); border-radius:24px;"><div style="font-size:40px;">ЁЯУЭ</div><div style="font-size:16px; margin-top:12px; font-weight:600;">рдЕрднреА рддрдХ рдХреЛрдИ рдЧрдгрдирд╛ рдирд╣реАрдВ</div><div style="font-size:13px; margin-top:8px; color:#64748b;">рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЗрддрд┐рд╣рд╛рд╕ рджрд┐рдЦреЗрдЧрд╛</div></div>`;
                return;
            }
            list.innerHTML = h.map(x => {
                let dims = {};
                try { dims = JSON.parse(x.dimensions || '{}'); } catch(e) {}
                let dimText = '';
                if (x.shape === 'rectangle') dimText = `${dims.L || 0} ├Ч ${dims.W || 0}`;
                else if (x.shape === 'square') dimText = `${dims.S || 0} ├Ч ${dims.S || 0}`;
                else if (x.shape === 'triangle') dimText = `${dims.A || 0}, ${dims.B || 0}, ${dims.C || 0}`;
                else if (x.shape === 'parallelogram') dimText = `N${dims.m1||0} E${dims.m2||0} S${dims.m3||0} W${dims.m4||0}`;
                let paimanaBadge = x.paimana === "32" ? '<span style="background:#fef3c7; color:#92400e; padding:3px 12px; border-radius:30px; font-size:11px; font-weight:600;">32"</span>' : (x.paimana === "64" ? '<span style="background:#dbeafe; color:#1e40af; padding:3px 12px; border-radius:30px; font-size:11px; font-weight:600;">64"</span>' : '<span style="background:#e0e7ff; color:#4f46e5; padding:3px 12px; border-radius:30px; font-size:11px; font-weight:600;">16"</span>');
                return `<div class="history-item">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; flex-wrap:wrap; gap:8px;">
                        <div style="background:#f1f5f9; padding:5px 14px; border-radius:30px; font-size:12px; color:#475569;">ЁЯХТ ${x.time} | ${x.date}</div>
                        <div style="display:flex; gap:8px;"><span style="background:#e0e7ff; color:#4f46e5; padding:5px 16px; border-radius:30px; font-size:12px; font-weight:700;">${x.shape.toUpperCase()}</span>${paimanaBadge}</div>
                    </div>
                    <div style="background:#f8fafc; padding:12px; border-radius:16px; margin-bottom:12px;">
                        <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                            <span style="font-weight:600; color:#0f172a;">рд▓рдЧреНрдЧреА: ${x.laggi} рд╣рд╛рде</span>
                            <span style="background:#4f46e5; color:white; padding:4px 16px; border-radius:40px; font-weight:700; font-size:15px;">${x.kdh}</span>
                        </div>
                        ${dimText ? `<div style="text-align:center; font-size:12px; color:#475569; margin-top:10px; padding-top:10px; border-top:1px solid #e2e8f0;">ЁЯУР рдорд╛рдк: ${dimText}</div>` : ''}
                    </div>
                    <div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:8px;">
                        <div style="background:#f1f5f9; padding:8px; border-radius:12px; text-align:center;"><span style="display:block; font-size:10px; color:#64748b;">рд╡рд░реНрдЧ рдХрдбрд╝реА</span><span style="font-weight:700; color:#0f172a;">${x.kadi}</span></div>
                        <div style="background:#f1f5f9; padding:8px; border-radius:12px; text-align:center;"><span style="display:block; font-size:10px; color:#64748b;">рд╡рд░реНрдЧ рдлреАрдЯ</span><span style="font-weight:700; color:#0f172a;">${x.ft}</span></div>
                        <div style="background:#f1f5f9; padding:8px; border-radius:12px; text-align:center;"><span style="display:block; font-size:10px; color:#64748b;">рдбрд┐рд╕рдорд┐рд▓</span><span style="font-weight:700; color:#0f172a;">${x.dec}</span></div>
                        <div style="background:#f1f5f9; padding:8px; border-radius:12px; text-align:center;"><span style="display:block; font-size:10px; color:#64748b;">рдкреИрдорд╛рдирд╛</span><span style="font-weight:700; color:#0f172a;">${x.paimana}"</span></div>
                    </div>
                </div>`;
            }).join('');
        }

        function updateHistoryCount() {
            let h = []; try { h = JSON.parse(localStorage.getItem('landCalcHist')) || []; } catch(e) {}
            document.getElementById('historyCount').textContent = h.length;
        }

        function clearHistory() {
            if (confirm("рдХреНрдпрд╛ рдЖрдк рд╡рд╛рдХрдИ рд╕рднреА рд╣рд┐рд╕реНрдЯреНрд░реА рдорд┐рдЯрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ?")) {
                localStorage.removeItem('landCalcHist');
                renderHistory();
                updateHistoryCount();
            }
        }

        function toggleHistory() {
            const content = document.getElementById('historyContent');
            const icon = document.getElementById('historyIcon');
            const isVisible = content.style.display === "block";
            content.style.display = isVisible ? "none" : "block";
            icon.innerText = isVisible ? "тЦ╝" : "тЦ▓";
        }

        function resetAll() {
            document.querySelectorAll('#inputs input').forEach(i => i.value = "");
            document.getElementById('resultCard').style.display = "none";
            document.getElementById('warningArea').innerHTML = "";
            document.getElementById('diagram').innerHTML = "";
            document.getElementById('scaleInfo').innerHTML = "";
        }

        window.addEventListener('DOMContentLoaded', initApp);
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
